<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Portfolio Analysis System</title>
    
    <!-- Cache optimization meta tags -->
    <meta http-equiv="Cache-Control" content="max-age=31536000, public">
    <meta http-equiv="Expires" content="Wed, 21 Oct 2025 07:28:00 GMT">
    <meta name="description" content="Multi-Agent Portfolio Analysis System - Powered by Vercel Serverless Functions">
    <meta name="keywords" content="portfolio analysis, stock analysis, serverless, vercel, flask">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/api/app" as="fetch" crossorigin>
    
    <!-- Minified CSS -->
    <style>
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;min-height:100vh}.container{max-width:800px;margin:0 auto;background:rgba(255,255,255,0.1);padding:40px;border-radius:20px;backdrop-filter:blur(10px);box-shadow:0 8px 32px rgba(0,0,0,0.3)}h1{text-align:center;font-size:2.5em;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,0.3)}.subtitle{text-align:center;font-size:1.2em;margin-bottom:30px;opacity:0.9}.migration-notice{background:rgba(255,255,255,0.15);padding:20px;border-radius:10px;margin:20px 0;border-left:4px solid #ffd700}.feature-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:30px 0}.feature-card{background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;text-align:center}.feature-icon{font-size:2em;margin-bottom:10px}.btn{display:inline-block;background:#28a745;color:white;padding:15px 30px;text-decoration:none;border-radius:25px;font-weight:bold;margin:10px;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(0,0,0,0.2);cursor:pointer}.btn:hover{background:#218838;transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.3)}.btn-secondary{background:#6c757d}.btn-secondary:hover{background:#545b62}.actions{text-align:center;margin:30px 0}.tech-stack{display:flex;justify-content:space-around;flex-wrap:wrap;margin:20px 0}.tech-item{background:rgba(255,255,255,0.1);padding:10px 20px;border-radius:20px;margin:5px;font-size:0.9em}.code-block{background:rgba(0,0,0,0.3);padding:15px;border-radius:8px;font-family:'Courier New',monospace;margin:15px 0;overflow-x:auto}.status-indicator{display:inline-block;width:12px;height:12px;border-radius:50%;background:#28a745;margin-right:8px;animation:pulse 2s infinite}.loading{opacity:0.7;pointer-events:none}.error{border:2px solid #dc3545;background:rgba(220,53,69,0.1)}.success{border:2px solid #28a745;background:rgba(40,167,69,0.1)}@keyframes pulse{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}@media(max-width:768px){.container{padding:20px;margin:10px}.feature-list{grid-template-columns:1fr}.tech-stack{flex-direction:column;align-items:center}}
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Multi-Agent Portfolio Analysis System</h1>
        <p class="subtitle">
            <span class="status-indicator" id="statusIndicator"></span>
            <span id="systemStatus">Powered by Vercel Serverless Functions</span>
        </p>
        
        <div class="migration-notice">
            <h3>‚ö° Migration to Flask Complete!</h3>
            <p>
                The Streamlit application has been successfully migrated to a Flask-based serverless architecture 
                for optimal Vercel deployment. This resolves all schema validation errors and provides 
                better performance in serverless environments.
            </p>
        </div>
        
        <div class="feature-list">
            <div class="feature-card">
                <div class="feature-icon">üìä</div>
                <h3>Portfolio Dashboard</h3>
                <p>Real-time portfolio analysis with risk assessment and volatility tracking</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üîç</div>
                <h3>Stock Analysis</h3>
                <p>Individual ticker analysis with impact level detection and email alerts</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üìà</div>
                <h3>Market Insights</h3>
                <p>Automated insights generation and knowledge evolution tracking</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üö®</div>
                <h3>Alert System</h3>
                <p>Email notifications for high-impact events and portfolio changes</p>
            </div>
        </div>
        
        <div class="actions">
            <a href="/api/app" class="btn" id="launchBtn">üéØ Launch Dashboard</a>
            <a href="/api/app" class="btn btn-secondary" id="statusBtn">üì± API Status</a>
        </div>
        
        <div class="migration-notice">
            <h3>üîß Technical Migration Details</h3>
            <p><strong>Issues Resolved:</strong></p>
            <ul>
                <li>‚úÖ Vercel framework schema validation error fixed</li>
                <li>‚úÖ Streamlit server model replaced with Flask serverless functions</li>
                <li>‚úÖ SQLite persistence replaced with in-memory storage</li>
                <li>‚úÖ Background scheduling adapted for serverless execution</li>
                <li>‚úÖ Heavy dependencies (autogen, apscheduler) decoupled</li>
            </ul>
            
            <p><strong>New Architecture:</strong></p>
            <div class="tech-stack">
                <div class="tech-item">Flask API</div>
                <div class="tech-item">Vercel Serverless</div>
                <div class="tech-item">HTML/JavaScript Frontend</div>
                <div class="tech-item">In-Memory Storage</div>
                <div class="tech-item">Email Integration</div>
            </div>
        </div>
        
        <div class="migration-notice">
            <h3>üöÄ Deployment Instructions</h3>
            <div class="code-block">
# Deploy to Vercel
vercel --prod

# The Flask app will be available at:
# - Main dashboard: https://your-domain.vercel.app/
# - API endpoints: https://your-domain.vercel.app/api/app
            </div>
            
            <p><strong>Environment Variables Required:</strong></p>
            <div class="code-block">
XAI_API_KEY=your-xai-api-key
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SENDER_EMAIL=your-email@gmail.com
SENDER_PASSWORD=your-app-password
TO_EMAIL=recipient@example.com
            </div>
        </div>
        
        <div class="actions">
            <p style="margin-top: 30px; text-align: center; opacity: 0.8;">
                The original Streamlit application is preserved in the repository for reference and local development.
            </p>
        </div>
    </div>

    <!-- Minified JavaScript with debouncing and optimization -->
    <script>
        (function(){
            'use strict';
            
            // Debounce utility function
            function debounce(func,wait,immediate){
                var timeout;
                return function(){
                    var context=this,args=arguments;
                    var later=function(){
                        timeout=null;
                        if(!immediate)func.apply(context,args);
                    };
                    var callNow=immediate&&!timeout;
                    clearTimeout(timeout);
                    timeout=setTimeout(later,wait);
                    if(callNow)func.apply(context,args);
                };
            }
            
            // Cache for API responses
            var apiCache=new Map();
            
            // Optimized API call with caching and debouncing
            var apiCall=debounce(function(endpoint,callback){
                if(apiCache.has(endpoint)){
                    var cached=apiCache.get(endpoint);
                    if(Date.now()-cached.timestamp<30000){
                        callback(cached.data);
                        return;
                    }
                }
                
                fetch(endpoint)
                    .then(function(response){return response.json();})
                    .then(function(data){
                        apiCache.set(endpoint,{data:data,timestamp:Date.now()});
                        callback(data);
                    })
                    .catch(function(error){
                        console.error('API Error:',error);
                        callback({error:error.message});
                    });
            },300);
            
            // System status checker with debouncing
            function checkSystemStatus(){
                var statusIndicator=document.getElementById('statusIndicator');
                var systemStatus=document.getElementById('systemStatus');
                
                apiCall('/api/app',function(data){
                    if(data.error){
                        statusIndicator.style.background='#dc3545';
                        systemStatus.textContent='System Error';
                    }else{
                        statusIndicator.style.background='#28a745';
                        systemStatus.textContent='System Online - '+data.framework;
                    }
                });
            }
            
            // Optimized button click handlers with debouncing
            var debouncedStatusCheck=debounce(checkSystemStatus,500);
            
            // Initialize on DOM ready
            document.addEventListener('DOMContentLoaded',function(){
                var launchBtn=document.getElementById('launchBtn');
                var statusBtn=document.getElementById('statusBtn');
                
                if(launchBtn){
                    launchBtn.addEventListener('click',function(e){
                        launchBtn.classList.add('loading');
                        setTimeout(function(){
                            launchBtn.classList.remove('loading');
                        },1000);
                    });
                }
                
                if(statusBtn){
                    statusBtn.addEventListener('click',function(e){
                        e.preventDefault();
                        debouncedStatusCheck();
                    });
                }
                
                // Initial status check
                setTimeout(debouncedStatusCheck,1000);
                
                // Periodic status updates with debouncing
                setInterval(debouncedStatusCheck,30000);
            });
            
            // Service worker registration for caching
            if('serviceWorker' in navigator){
                window.addEventListener('load',function(){
                    navigator.serviceWorker.register('/sw.js')
                        .then(function(registration){
                            console.log('SW registered: ',registration);
                        })
                        .catch(function(registrationError){
                            console.log('SW registration failed: ',registrationError);
                        });
                });
            }
            
            // Performance monitoring
            if('performance' in window){
                window.addEventListener('load',function(){
                    setTimeout(function(){
                        var loadTime=performance.timing.loadEventEnd-performance.timing.navigationStart;
                        console.log('Page load time:',loadTime+'ms');
                    },0);
                });
            }
        })();
    </script>
</body>
</html> 